// SPDX-FileCopyrightText: 2026 Spencer
// SPDX-License-Identifier: AGPL-3.0-only

import { Button } from "./components/button.slint";
import { RestoreLogic } from "./logic/restore.slint";
import { ThemeLogic } from "./logic/theme.slint";

export component RestoreDialog inherits Window {
  title: @tr("Aletheia - Restore backup");
  preferred-width: 520px;
  preferred-height: 220px;
  background: ThemeLogic.colors.background;

  Rectangle {
    background: ThemeLogic.colors.surface;

    VerticalLayout {
      padding: 24px;
      spacing: 24px;

      VerticalLayout {
        spacing: 8px;
        alignment: start;

        Text {
          text: @tr("Restore Backup?");
          color: ThemeLogic.colors.text_primary;
          font-family: "Inter";
          font-size: 20px;
          font-weight: 700;
        }

        Text {
          color: ThemeLogic.colors.text_secondary;
          text: @tr("Are you sure you want to restore {}?", RestoreLogic.game_name);
          font-family: "Inter";
          font-size: 15px;
          font-weight: 400;
        }

        if RestoreLogic.error.is-empty: Text {
          text: @tr("This will overwrite any existing save data.");
          color: ThemeLogic.colors.text_muted;
          font-family: "Inter";
          font-size: 13px;
          font-weight: 400;
        }

        if !RestoreLogic.error.is-empty: Rectangle {
          background: ThemeLogic.colors.restore_dialog_error_background;
          border-radius: 8px;
          border-width: 1px;
          border-color: ThemeLogic.colors.restore_dialog_error_border;

          VerticalLayout {
            padding: 12px;

            Text {
              text: RestoreLogic.translate_error();
              color: ThemeLogic.colors.text_primary;
              font-family: "Inter";
              font-size: 14px;
              font-weight: 400;
            }
          }
        }
      }

      HorizontalLayout {
        alignment: end;
        spacing: 12px;

        Button {
          text: RestoreLogic.error.is-empty ? @tr("Cancel") : @tr("Close");
          background: ThemeLogic.colors.secondary;
          width: 100px;
          height: 36px;
          clicked => RestoreLogic.cancel();
        }

        if RestoreLogic.error.is-empty: Button {
          text: @tr("Restore");
          background: ThemeLogic.colors.primary;
          width: 100px;
          height: 36px;
          clicked => RestoreLogic.restore();
        }
      }
    }
  }
}
